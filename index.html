<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Livret d'Apprentissage - Candidat Libre Permis B</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <!-- Font Awesome -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
  />
  <!-- Google Maps API (Places) -->
  <script
    async
    defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDSV-dmqFiZe4Y7B_UmD4iDJpjIYJzWGIc&libraries=places"
  ></script>

  <style>
    /* ==== Réinitialisation ==== */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    html, body {
      height: 100%;
    }
    body {
      font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
      background-color: #fff9e6; /* Fond jaune pâle */
      color: #fff;
      line-height: 1.6;
    }

    /* ============================
       PAGE AUTHENTIFICATION
    ============================ */
    #authPage {
      max-width: 400px;
      margin: 40px auto;
      background: #111;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(255,255,255,0.1);
      text-align: center;
    }
    #authPage header {
      margin-bottom: 20px;
    }
    #logoContainer {
      text-align: center;
    }
    #logoContainer img {
      max-width: 200px;
      height: auto;
    }

    .welcome-text {
      margin-bottom: 20px;
      font-size: 0.95em;
      color: #ccc;
      font-weight: bold; /* Mise en gras */
    }

    .auth-tabs {
      display: flex;
      justify-content: center;
      margin-bottom: 20px;
    }
    .auth-tabs button {
      flex: 1;
      padding: 10px;
      background: #fceec7;
      color: #000;
      border: none;
      cursor: pointer;
      font-size: 1em;
      border-radius: 8px;
      margin: 0 5px;
      transition: background 0.3s;
    }
    .auth-tabs button.active,
    .auth-tabs button:hover {
      background: #FFA500;
    }
    .auth-form {
      display: none;
      text-align: left;
      position: relative; /* Permet la position absolute de l’icône */
    }
    .auth-form.active {
      display: block;
    }
    .auth-field {
      margin-bottom: 15px;
      position: relative;
    }
    .auth-field label {
      display: block;
      margin-bottom: 5px;
    }
    .auth-field input {
      width: 100%;
      padding: 8px;
      border: 1px solid #555;
      border-radius: 4px;
      background: #222;
      color: #fff;
    }
    .auth-field small {
      display: block;
      color: #ccc;
      margin-top: 7px;
      font-size: 0.8em;
    }
    .toggle-password {
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      cursor: pointer;
      color: #FFA500;
    }

    .auth-form button.btn {
      display: block;
      margin: 15px auto 0 auto;
      text-align: center;
    }
    #skipAuth {
      margin-top: 20px;
      display: block;
      background-color: #fceec7;
      color: #000;
    }
    
    /* =====================
       BOUTONS GÉNÉRIQUES
    ===================== */
    .btn {
      padding: 10px 20px;
      font-size: 1em;
      cursor: pointer;
      border: 1px solid transparent;
      border-radius: 8px;
      background-color: #fceec7;
      color: #000;
      margin: 10px auto;
      text-align: center;
      transition: background 0.3s, border 0.3s;
    }
    .btn:hover {
      background-color: #FFA500;
      border: 1px solid #FFA500;
      color: #000;
    }

    /* ============================
       MAIN CONTENT & SIDEBAR
    ============================ */
    #mainContent {
      display: none;
    }
    #menuButton {
      position: fixed;
      top: 10px;
      left: 10px;
      width: 40px;
      height: 40px;
      background: #FFA500;
      border-radius: 8px;
      cursor: pointer;
      z-index: 3000;
      display: flex;
      align-items: center;
      justify-content: center;
      border: none;
      outline: none;
    }
    #menuButton i {
      font-size: 1.5em;
      color: #000;
    }

    #sidebar {
      position: fixed;
      top: 0;
      left: -250px;
      width: 250px;
      height: 100%;
      background: #fceec7;
      transition: left 0.3s;
      z-index: 2500;
      padding-top: 60px;
      color: #000;
    }
    #sidebar.active {
      left: 0;
    }
    #sidebar a {
      display: block;
      padding: 15px;
      background: #fceec7;
      color: #000;
      text-decoration: none;
      border-bottom: 1px solid #000;
      text-align: center;
      font-size: 1em;
      border-radius: 8px;
      margin: 5px 10px;
      transition: background 0.3s;
    }
    #sidebar a:hover,
    #sidebar a.active {
      background: #FFA500;
      color: #000;
    }

    /* =========================
       SECTION CANDIDAT
    ========================= */
    .section-content {
      max-width: 1200px;
      margin: 40px auto;
      padding: 0 20px;
      background: transparent;
    }
    .section-content h2 {
      font-size: 2em;
      margin-bottom: 10px;
      color: #000; /* Titre en noir */
      text-align: center;
    }
    .section-content h3 {
      font-size: 1.6em;
      margin-bottom: 10px;
      border-bottom: 1px solid #FFA500;
      padding-bottom: 5px;
      color: #fff;
    }
    #candidatSection.section-content {
      display: none;
    }
    #candidatSection article {
      background: #222;
      margin: 20px 0;
      padding: 15px;
      border: 1px solid #444;
      border-radius: 8px;
    }
    #candidatSection article:hover {
      border-color: #FFA500;
    }

    .info-field {
      margin-bottom: 15px;
      text-align: left;
    }
    .info-field label {
      font-weight: bold;
      margin-right: 8px;
    }
    .info-field input {
      padding: 5px;
      font-size: 1em;
      border: 1px solid #555;
      border-radius: 4px;
      background: #222;
      color: #fff;
      width: 100%;
      transition: border 0.3s;
    }
    .info-field input:hover {
      border: 2px solid #FFA500;
    }
    .neph-boxes {
      display: flex;
      flex-direction: row;
    }
    .neph-box {
      width: 25px;
      height: 25px;
      border: 1px solid #777;
      text-align: center;
      line-height: 25px;
      margin-right: 3px;
      transition: border 0.3s;
    }
    .neph-box:hover {
      border: 2px solid #FFA500;
    }
    .neph-box input {
      width: 100%;
      border: none;
      text-align: center;
      background: #222;
      color: #fff;
    }

    .photo-placeholder {
      width: 200px;
      height: 250px;
      border: 2px dashed #555;
      border-radius: 5px;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      color: #aaa;
      font-size: 0.9em;
      overflow: hidden;
      margin: 20px auto;
      transition: border 0.3s;
      border: 1px solid #fff;
    }
    .photo-placeholder:hover {
      border: 3px solid #FFA500;
    }
    .photo-placeholder img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      display: block;
    }
    .photo-placeholder input[type="file"] {
      position: absolute;
      width: 100%;
      height: 100%;
      opacity: 0;
      z-index: 2;
      cursor: pointer;
    }
    #photoPreview:not([src]) {
      display: none;
    }

    /* Récapitulatif candidat */
    #summaryView {
      display: none;
      margin: 20px auto;
      max-width: 600px;
      background: #222;
      padding: 20px;
      border-radius: 8px;
      border: 1px solid #999;
    }
    /* même style H3 que "Informations Candidat" */
    #summaryView h3 {
      font-size: 1.6em;
      margin-bottom: 10px;
      border-bottom: 1px solid #FFA500;
      padding-bottom: 5px;
      color: #fff;
      text-align: center;
    }
    #summaryView p {
      margin: 5px 0;
      color: #FFF;
    }
    #editBtn, #resetBtn, #demarrerBtn {
      display: none;
      margin: 10px 5px;
    }

    /* =========================
       CONTENU PÉDAGOGIQUE
    ========================= */
    .toc {
      text-align: left;
    }
    .toc a {
      color: #000;
      text-decoration: none;
      transition: color 0.3s;
    }
    .toc a:hover {
      text-decoration: underline;
      color: #FFA500;
    }
    .section-content h4 {
      font-size: 1.3em;
      margin-bottom: 8px;
      color: #FFA500;
    }
    .section-content article:hover {
      border-color: #FFA500;
    }

    /* ===================
       MODULE SUIVI
    =================== */
    .suivi-container {
      background: #222;
      padding: 20px;
      border-radius: 8px;
      margin-top: 20px;
      transition: border 0.3s;
      border: 1px solid #fff;
    }
    .suivi-container:hover {
      border: 3px solid #FFA500;
    }
    .suivi-container h2 {
      text-align: center;
      margin-bottom: 20px;
      border: 2px solid #333;
      padding: 10px;
      border-radius: 8px;
      cursor: pointer;
      transition: border 0.3s;
    }
    .suivi-container h2:hover {
      border: 3px solid #FFA500;
    }
    .suivi-form {
      display: grid;
      grid-template-columns: repeat(2,1fr);
      gap: 10px;
    }
    .suivi-form label {
      font-weight: bold;
    }
    .suivi-form input,
    .suivi-form select,
    .suivi-form textarea {
      width: 100%;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 5px;
      transition: border 0.3s;
    }
    .suivi-form input:hover,
    .suivi-form select:hover,
    .suivi-form textarea:hover {
      border: 2px solid #FFA500;
    }
    .suivi-form button {
      grid-column: span 2;
      background-color: #fceec7;
      color: #000;
      padding: 10px;
      border: none;
      cursor: pointer;
      border-radius: 5px;
      transition: background 0.3s, border 0.3s;
    }
    .suivi-form button:hover {
      background-color: #FFA500;
      border: 2px solid #FFA500;
      color: #000;
    }
    table.suivi-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    table.suivi-table th, table.suivi-table td {
      border: 1px solid #FFA500;
      padding: 8px;
      text-align: center;
      color: #fff;
    }
    table.suivi-table th {
      background: #333;
    }
    .progress-circle {
      border: 2px solid #FFA500;
      border-radius: 50%;
      width: 80px;
      height: 80px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .progress-circle span {
      color: #FFA500;
      font-size: 1.1em;
    }

    /* Footer */
    .footer {
      text-align: center;
      margin-top: 20px;
      font-size: 0.9em;
      color: #000;
      background: #FFA500;
      padding: 10px;
    }

    /* Responsive */
    @media (max-width:768px) {
      .section-content {
        padding: 0 20px;
      }
      .suivi-form {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>

<!-- ========== Page d'authentification ========== -->
<div id="authPage">
  <header>
    <div id="logoContainer">
      <img src="mon_logo.png.png" alt="Mon Logo" style="max-width: 200px; height:auto;">
    </div>
  </header>

  <p class="welcome-text">
    Bienvenue ! Rejoignez DriveMeNow pour accéder à votre guide complet et votre livret d'apprentissage personnalisé pour réussir le permis de conduire en candidat libre. Inscrivez-vous ou connectez-vous dès maintenant.
  </p>

  <div class="auth-tabs">
    <button id="loginTab" class="active">Connexion</button>
    <button id="registerTab">Inscription</button>
  </div>

  <!-- Formulaire de connexion -->
  <div id="loginFormContainer" class="auth-form active">
    <h2 style="text-align:center;">Connexion</h2>
    <form id="loginForm">
      <div class="auth-field">
        <label for="loginEmail">Email :</label>
        <input type="email" id="loginEmail" name="loginEmail" placeholder="Votre email" required />
      </div>
      <div class="auth-field">
        <label for="loginPassword">Mot de passe :</label>
        <input type="password" id="loginPassword" name="loginPassword" placeholder="Votre mot de passe" required />
        <small>Min. 9 caractères, 1 majuscule, 1 minuscule, 1 chiffre</small>
        <i class="fas fa-eye toggle-password" id="toggleLoginPassword"></i>
      </div>
      <div class="auth-field">
        <label for="loginCode">Code à usage unique :</label>
        <input type="text" id="loginCode" name="loginCode" placeholder="Code reçu par email" required />
      </div>
      <button type="submit" class="btn">Se connecter</button>
    </form>
  </div>

  <!-- Formulaire d'inscription -->
  <div id="registerFormContainer" class="auth-form">
    <h2 style="text-align:center;">Inscription</h2>
    <form id="registerForm">
      <div class="auth-field">
        <label for="regName">Nom :</label>
        <input type="text" id="regName" name="regName" placeholder="Votre nom" style="text-transform: capitalize;" required />
      </div>
      <div class="auth-field">
        <label for="regPrenom">Prénom :</label>
        <input type="text" id="regPrenom" name="regPrenom" placeholder="Votre prénom" style="text-transform: capitalize;" required />
      </div>
      <div class="auth-field">
        <label for="regEmail">Email :</label>
        <input type="email" id="regEmail" name="regEmail" placeholder="Votre email" required />
      </div>
      <div class="auth-field">
        <label for="regPassword">Mot de passe :</label>
        <input type="password" id="regPassword" name="regPassword" placeholder="Votre mot de passe" required />
        <small>Min. 9 caractères, 1 majuscule, 1 minuscule, 1 chiffre</small>
        <i class="fas fa-eye toggle-password" data-target="regPassword"></i>
      </div>
      <!-- Petit <small> caché pour alignement -->
      <div class="auth-field">
        <label for="regPasswordConfirm">Confirmer le mot de passe :</label>
        <input type="password" id="regPasswordConfirm" name="regPasswordConfirm" placeholder="Confirmez votre mot de passe" required />
        <small style="visibility:hidden;">(Alignement)</small>
        <i class="fas fa-eye toggle-password" data-target="regPasswordConfirm"></i>
      </div>
      <button type="submit" class="btn">S'inscrire</button>
    </form>
  </div>

  <button class="btn" id="skipAuth">Passer l’authentification</button>
</div>

<!-- ========== Contenu principal ========== -->
<div id="mainContent">
  <button id="menuButton"><i class="fas fa-bars"></i></button>

  <div id="sidebar">
    <a href="#" id="coverPageBtn"><i class="fas fa-user"></i><br>CANDIDAT</a>
    <a href="#accueilSection" id="accueilBtn"><i class="fas fa-home"></i><br>ACCUEIL</a>
    <a href="#inscriptionSection" id="inscriptionLink"><i class="fas fa-file-alt"></i><br>INSCRIPTION</a>
    <a href="#suiviSection" id="suiviLink"><i class="fas fa-traffic-light"></i><br>SUIVI</a>
    <a href="#examenSection" id="examenLink"><i class="fas fa-laptop"></i><br>EXAMENS</a>
    <a href="#permisSection" id="permisLink"><i class="fas fa-id-card"></i><br>PERMIS</a>
  </div>

  <!-- ========== Page Candidat ========== -->
  <section id="candidatSection" class="section-content" style="display:none;">
    <header>
      <h2>CANDIDAT</h2>
      <!-- Supprimons "Coordonnées" / "Photo" pour ne laisser que "Informations Candidat" -->
      <nav class="toc">
        <ul>
          <!-- Un seul lien : renvoie soit au formulaire (si non validé), soit au récap. -->
          <li><a href="#" id="infosLink">Coordonnées & informations Candidat</a></li>
        </ul>
      </nav>
    </header>

    <article>
      <form id="infoForm" action="#" method="post" enctype="multipart/form-data">
        <!-- =========== COORDONNÉES =========== -->
        <div class="info-field">
          <label for="nom">Nom du candidat :</label>
          <input type="text" id="nom" name="nom" placeholder="Votre nom" required />
        </div>
        <div class="info-field">
          <label for="prenom">Prénom du candidat :</label>
          <input type="text" id="prenom" name="prenom" placeholder="Votre prénom" required />
        </div>
        <div class="info-field">
          <label for="date-naissance">Date de naissance :</label>
          <input type="date" id="date-naissance" name="date_naissance" max="2008-12-31" required />
        </div>
        <div class="info-field">
          <label for="adresse">Adresse :</label>
          <input type="search" id="adresse" name="adresse" placeholder="Votre adresse" required />
        </div>
        <div class="info-field">
          <label for="code-postal">Code postal :</label>
          <input type="text" id="code-postal" name="code_postal" placeholder="Code postal" required />
        </div>
        <div class="info-field">
          <label for="commune">Commune :</label>
          <input type="text" id="commune" name="commune" placeholder="Votre commune" required />
        </div>
        <div class="info-field">
          <label for="telephone"><i class="fas fa-phone"></i> Téléphone :</label>
          <input type="tel" id="telephone" name="telephone" placeholder="Votre numéro" required />
        </div>
        <div class="info-field">
          <label for="email"><i class="fas fa-envelope"></i> Email :</label>
          <input type="email" id="email" name="email" placeholder="Votre email" required />
        </div>
        <div class="info-field">
          <label for="responsable">Responsable de la formation :</label>
          <input type="text" id="responsable" name="responsable" placeholder="Nom du responsable" required />
        </div>

        <!-- =========== INFORMATIONS CANDIDAT =========== -->
        <div class="info-field">
          <label for="date-debut">Date de début de formation :</label>
          <input type="date" id="date-debut" name="date_debut" required />
        </div>
        <div class="info-field">
          <label>Numéro d'inscription NEPH * :</label>
          <div class="neph-boxes">
            <!-- 12 cases NEPH -->
            <div class="neph-box"><input type="text" name="neph[]" maxlength="1" pattern="[0-9]" /></div>
            <div class="neph-box"><input type="text" name="neph[]" maxlength="1" pattern="[0-9]" /></div>
            <div class="neph-box"><input type="text" name="neph[]" maxlength="1" pattern="[0-9]" /></div>
            <div class="neph-box"><input type="text" name="neph[]" maxlength="1" pattern="[0-9]" /></div>
            <div class="neph-box"><input type="text" name="neph[]" maxlength="1" pattern="[0-9]" /></div>
            <div class="neph-box"><input type="text" name="neph[]" maxlength="1" pattern="[0-9]" /></div>
            <div class="neph-box"><input type="text" name="neph[]" maxlength="1" pattern="[0-9]" /></div>
            <div class="neph-box"><input type="text" name="neph[]" maxlength="1" pattern="[0-9]" /></div>
            <div class="neph-box"><input type="text" name="neph[]" maxlength="1" pattern="[0-9]" /></div>
            <div class="neph-box"><input type="text" name="neph[]" maxlength="1" pattern="[0-9]" /></div>
            <div class="neph-box"><input type="text" name="neph[]" maxlength="1" pattern="[0-9]" /></div>
            <div class="neph-box"><input type="text" name="neph[]" maxlength="1" pattern="[0-9]" /></div>
          </div>
        </div>

        <!-- Encadrement de la photo, juste avant le bouton Envoyer -->
        <div class="photo-placeholder">
          <span id="photoPlaceholderText">Ajouter une photo</span>
          <img id="photoPreview" alt="Prévisualisation de la photo" />
          <input type="file" name="photo" accept="image/*" required />
        </div>

        <div style="text-align:center;">
          <button type="submit" class="btn">Envoyer</button>
        </div>
        <label style="display:block; margin-top:10px; font-size:0.9em; text-align:center; color:#ccc;">
          * NEPH : Délivré sur demande – à remplir une fois obtenu.
        </label>
      </form>
    </article>
    
    <!-- Récapitulatif candidat -->
    <div id="summaryView">
      <h3>Coordonnées & informations Candidait</h3>
      <p>Nom : <span id="sumNom"></span></p>
      <p>Prénom : <span id="sumPrenom"></span></p>
      <p>Date de naissance : <span id="sumDateNaissance"></span></p>
      <p>Adresse : <span id="sumAdresse"></span></p>
      <p>Code postal : <span id="sumCodePostal"></span></p>
      <p>Commune : <span id="sumCommune"></span></p>
      <p>Téléphone : <span id="sumTelephone"></span></p>
      <p>Email : <span id="sumEmail"></span></p>
      <p>Responsable : <span id="sumResponsable"></span></p>
      <p>NEPH : <span id="sumNeph"></span></p>
      <p>Date de début de formation : <span id="sumDateDebut"></span></p>
      <img id="sumPhoto" alt="Photo" style="max-width:200px; margin-top:10px;" />

      <div style="text-align:center; margin-top:20px;">
        <button id="editBtn" class="btn">Modifier</button>
        <button id="resetBtn" class="btn">Réinitialiser</button>
        <button id="demarrerBtn" class="btn">Démarrer</button>
      </div>
    </div>
  </section>

  <!-- ========== Contenu pédagogique ========== -->
  <div id="contentPage">
    <!-- SECTION ACCUEIL -->
    <section id="accueilSection" class="section-content" style="display:block;">
      <header>
        <h2>ACCUEIL</h2>
        <nav class="toc">
          <ul>
            <li><a href="#accueilProgression">Progression & Indicateurs</a></li>
            <li><a href="#annexes">Annexes</a></li>
          </ul>
        </nav>
      </header>
      <article id="accueilProgression">
        <h3>Progression Administrative et Formation Pratique</h3>
        <p>Suivez l'avancement de vos démarches administratives et de votre formation grâce à des indicateurs visuels dynamiques.</p>
        <div style="display:flex; gap:20px; justify-content:center; margin-top:10px;">
          <div style="text-align:center;">
            <p>Administrative</p>
            <div class="progress-circle">
              <span id="adminProgress">0%</span>
            </div>
          </div>
          <div style="text-align:center;">
            <p>Formation Pratique</p>
            <div class="progress-circle">
              <span id="pratiqueProgress">0%</span>
            </div>
          </div>
        </div>
      </article>
      <article id="annexes">
        <h3>Annexes</h3>
        <ul>
          <li><strong>Glossaire :</strong> Définitions clés (Accompagnateur, NEPH, ASSR/ASR, etc.).</li>
          <li><strong>Contacts Utiles :</strong> Liens vers ANTS, RdvPermis, etc.</li>
          <li><strong>FAQ :</strong> Réponses aux questions fréquentes.</li>
        </ul>
      </article>
    </section>

    <!-- SECTION INSCRIPTION -->
    <section id="inscriptionSection" class="section-content" style="display:none;">
      <header>
        <h2>INSCRIPTION</h2>
        <nav class="toc">
          <ul>
            <li><a href="#introductionInscription">Introduction</a></li>
            <li><a href="#infosGenerales">Informations Générales</a></li>
            <li><a href="#demarchesInscription">Démarches d'Inscription</a></li>
          </ul>
        </nav>
      </header>
      <article id="introductionInscription">
        <h3>Introduction</h3>
        <p>Ce livret vous guide dans vos démarches d'inscription et de préparation. Suivez les instructions pour optimiser votre parcours vers le permis de conduire.</p>
      </article>
      <article id="infosGenerales">
        <h3>Informations Générales</h3>
        <h4>Prérequis pour débuter</h4>
        <ul>
          <li>Âge requis : 17 ans ou plus pour l’examen pratique, 16 ans pour l’examen théorique.</li>
          <li>Attestation de sécurité routière (ASSR/ASR) ou déclaration sur l’honneur.</li>
          <li>Justification de résidence en France depuis au moins 6 mois.</li>
          <li>Contrôle médical en cas de problème de santé.</li>
        </ul>
        <h4>Obligations de l’accompagnateur</h4>
        <p>L’accompagnateur doit être titulaire du permis B depuis au moins 5 ans, agir bénévolement et veiller à votre sécurité.</p>
      </article>
      <article id="demarchesInscription">
        <h3>Démarches d'Inscription</h3>
        <h4>Examen Théorique</h4>
        <ol>
          <li>Créez un compte sur <a href="https://ants.gouv.fr" target="_blank" style="color:#FFA500;">ANTS</a>.</li>
          <li>Fournissez les documents requis (pièce d’identité, justificatif de domicile, photo, attestation JDC).</li>
          <li>Validez votre demande pour obtenir votre numéro NEPH.</li>
        </ol>
        <h4>Examen Pratique</h4>
        <ol>
          <li>Connectez-vous ou créez un compte sur <a href="https://rdvpermis.fr" target="_blank" style="color:#FFA500;">RdvPermis</a>.</li>
          <li>Réservez votre examen en choisissant l’option « Inscription en candidat libre ».</li>
          <li>Fournissez les coordonnées de votre accompagnateur et planifiez l’examen.</li>
        </ol>
      </article>
    </section>

    <!-- SECTION SUIVI -->
    <section id="suiviSection" class="section-content" style="display:none;">
      <header>
        <h2>SUIVI</h2>
        <nav class="toc">
          <ul>
            <li><a href="#programmeFormation">Programme de Formation</a></li>
            <li><a href="#espaceSignature">Espace de Signature</a></li>
            <li><a href="#suiviSessions">Suivi des Sessions</a></li>
          </ul>
        </nav>
      </header>
      <article id="programmeFormation">
        <h3>Programme de Formation</h3>
        <h4>Formation Théorique</h4>
        <ul>
          <li>Supports pédagogiques : manuels, cours en ligne, applications interactives.</li>
          <li>Méthodes : planification, examens blancs, échanges entre candidats.</li>
          <li>Gestion du stress : techniques de relaxation et préparation mentale.</li>
        </ul>
        <h4>Formation Pratique</h4>
        <ul>
          <li>Préparation mentale et physique.</li>
          <li>Suivi technique des sessions de conduite.</li>
          <li>Évaluation régulière des compétences.</li>
        </ul>
        <h4>Exigences du Véhicule et Règles de Circulation</h4>
        <p>Le véhicule doit être assuré, signalé « Apprentissage » et conforme aux normes. Respectez le Code de la Route.</p>
      </article>
      <article id="espaceSignature">
        <h3>Espace de Signature</h3>
        <p>Après chaque session, formalisez votre progression :</p>
        <ul>
          <li><strong>Signature du Candidat :</strong> Attestation de suivi de la session.</li>
          <li><strong>Signature de l’Accompagnateur :</strong> Validation des compétences.</li>
        </ul>
        <p>Cette formalisation est essentielle pour suivre votre évolution.</p>
      </article>
      <article id="suiviSessions">
        <h3>Suivi des Sessions de Conduite</h3>
        <div class="suivi-container">
          <h2 onclick="document.getElementById('suiviTable').scrollIntoView({behavior:'smooth'});" style="cursor:pointer;">Suivi des Sessions de Conduite</h2>
          <form class="suivi-form" id="suiviForm">
            <label for="dateSession">Date :</label>
            <input type="date" id="dateSession" required>
            
            <label for="lieuSession">Lieu :</label>
            <select id="lieuSession">
              <option value="Centre-ville">Centre-ville</option>
              <option value="Route nationale">Route nationale</option>
              <option value="Parking">Parking</option>
              <option value="Zone rurale">Zone rurale</option>
              <option value="Autoroute">Autoroute</option>
              <option value="Chemin privé">Chemin privé</option>
            </select>
            
            <label for="traficSession">Trafic :</label>
            <select id="traficSession">
              <option value="Faible">Faible</option>
              <option value="Moyen">Moyen</option>
              <option value="Dense">Dense</option>
            </select>
            
            <label for="elementSession">Élément à évaluer :</label>
            <select id="elementSession">
              <option>Organes du véhicule</option>
              <option>Vérifications extérieures</option>
              <option>Installation au poste</option>
              <option>Démarrage et arrêt</option>
              <option>Accélération / Freinage</option>
              <option>Marche arrière et demi-tour</option>
            </select>
            
            <label for="autoEvalSession">Auto-évaluation :</label>
            <select id="autoEvalSession">
              <option>En initiation</option>
              <option>En progression</option>
              <option>Maîtrisé</option>
            </select>
            
            <label for="progressionSession">Progression pédagogique :</label>
            <select id="progressionSession">
              <option>En initiation</option>
              <option>En progression</option>
              <option>Maîtrisé</option>
            </select>
            
            <label for="assistanceSession">Assistance :</label>
            <select id="assistanceSession">
              <option>Fréquente</option>
              <option>Modérée</option>
              <option>Légère</option>
            </select>
            
            <label for="remarquesSession">Observations :</label>
            <textarea id="remarquesSession"></textarea>
            
            <label for="objectifsSession">Objectifs :</label>
            <textarea id="objectifsSession"></textarea>
            
            <button type="button" onclick="ajouterSession()">Ajouter au Tableau</button>
          </form>
          <table class="suivi-table" id="suiviTable">
            <thead>
              <tr>
                <th>Date</th>
                <th>Lieu</th>
                <th>Trafic</th>
                <th>Élément évalué</th>
                <th>Auto-évaluation</th>
                <th>Progression</th>
                <th>Assistance</th>
                <th>Observations</th>
                <th>Objectifs</th>
              </tr>
            </thead>
            <tbody id="suiviTbody">
              <!-- Lignes ajoutées dynamiquement -->
            </tbody>
          </table>
        </div>
      </article>
    </section>

    <!-- SECTION EXAMENS -->
    <section id="examenSection" class="section-content" style="display:none;">
      <header>
        <h2>EXAMENS</h2>
        <nav class="toc">
          <ul>
            <li><a href="#modalitesPermis">Modalités du Permis</a></li>
            <li><a href="#exempleJourJ">Exemple du Jour J</a></li>
            <li><a href="#conclusionExamen">Conclusion</a></li>
          </ul>
        </nav>
      </header>
      <article id="modalitesPermis">
        <h3>Modalités du Permis en Candidat Libre</h3>
        <ul>
          <li><strong>Conditions :</strong> 17 ans minimum pour l’inscription et l’examen pratique.</li>
          <li><strong>Accessibilité :</strong> Option flexible et économique, distincte de l’auto-école traditionnelle.</li>
          <li><strong>Différences :</strong> Pas de conduite accompagnée pour les candidats libres.</li>
        </ul>
      </article>
      <article id="exempleJourJ">
        <h3>Exemple du Jour J</h3>
        <ol>
          <li>Accueil et vérification des documents et du véhicule.</li>
          <li>Parcours de conduite d’environ 25 minutes sur divers types de routes.</li>
          <li>Attribution des points via une grille d’évaluation (visuel CEPC intégré).</li>
          <li>Examen blanc pour se familiariser avec les conditions réelles.</li>
        </ol>
      </article>
      <article id="conclusionExamen">
        <h3>Conclusion</h3>
        <p>Avant le Jour J, assurez-vous d'avoir tous les documents obligatoires, révisez les consignes et restez concentré pour réussir votre examen.</p>
      </article>
    </section>

    <!-- SECTION PERMIS -->
    <section id="permisSection" class="section-content" style="display:none;">
      <header>
        <h2>PERMIS</h2>
        <nav class="toc">
          <ul>
            <li><a href="#resultatsExamen">Résultats d'Examen Pratique</a></li>
            <li><a href="#fabricationTitre">Fabrication du Titre</a></li>
          </ul>
        </nav>
      </header>
      <article id="resultatsExamen">
        <h3>Résultats d'Examen Pratique</h3>
        <p>Interprétez vos résultats grâce à une grille d’évaluation détaillée et identifiez les axes d’amélioration.</p>
      </article>
      <article id="fabricationTitre">
        <h3>Fabrication du Titre</h3>
        <p>Découvrez le processus de fabrication de votre permis, depuis la validation des épreuves jusqu’à la réception officielle.</p>
      </article>
    </section>
  </div>
</div>

<div class="footer">
  "Prenez le volant de votre avenir et conduisez vers la liberté"
</div>

<script>
/* =====================
   FONCTIONS COMMUNES
===================== */
function capitalize(str) {
  return str.replace(/\b\w/g, char => char.toUpperCase());
}
function hideAllSections() {
  document.querySelectorAll('.section-content').forEach(sec => {
    sec.style.display = 'none';
  });
}
function scrollTopPage() {
  window.scrollTo(0, 0);
}
function updateMenuVisibility() {
  const mainContentStyle = window.getComputedStyle(document.getElementById('mainContent'));
  const menuButton = document.getElementById('menuButton');
  if (menuButton) {
    menuButton.style.display = (mainContentStyle.display === 'block') ? 'flex' : 'none';
  }
}

/* =====================
   AUTHENTIFICATION
===================== */
const loginTab = document.getElementById('loginTab');
const registerTab = document.getElementById('registerTab');
const loginFormContainer = document.getElementById('loginFormContainer');
const registerFormContainer = document.getElementById('registerFormContainer');

// Tabs
loginTab.addEventListener('click', () => {
  loginTab.classList.add('active');
  registerTab.classList.remove('active');
  loginFormContainer.classList.add('active');
  registerFormContainer.classList.remove('active');
});
registerTab.addEventListener('click', () => {
  registerTab.classList.add('active');
  loginTab.classList.remove('active');
  registerFormContainer.classList.add('active');
  loginFormContainer.classList.remove('active');
});

// Toggle mot de passe
function setupTogglePassword(toggleElement, targetInput) {
  toggleElement.addEventListener('click', () => {
    if (targetInput.type === "password") {
      targetInput.type = "text";
      toggleElement.classList.remove('fa-eye');
      toggleElement.classList.add('fa-eye-slash');
    } else {
      targetInput.type = "password";
      toggleElement.classList.remove('fa-eye-slash');
      toggleElement.classList.add('fa-eye');
    }
  });
}
const toggleLoginPassword = document.getElementById('toggleLoginPassword');
setupTogglePassword(toggleLoginPassword, document.getElementById('loginPassword'));

document.querySelectorAll('.auth-form .toggle-password').forEach(icon => {
  const targetId = icon.getAttribute('data-target') || icon.id.replace('toggle','');
  const targetInput = document.getElementById(targetId);
  if (targetInput) {
    setupTogglePassword(icon, targetInput);
  }
});

// Form inscription
document.getElementById('registerForm').addEventListener('submit', e => {
  e.preventDefault();
  const regPassword = document.getElementById('regPassword').value;
  const regPasswordConfirm = document.getElementById('regPasswordConfirm').value;
  const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).{9,}$/;

  if (!passwordRegex.test(regPassword)) {
    alert("Le mot de passe doit contenir au moins 9 caractères, une majuscule, une minuscule et un chiffre.");
    return;
  }
  if (regPassword !== regPasswordConfirm) {
    alert("Les mots de passe ne correspondent pas.");
    return;
  }
  // Simulation d'un code unique
  const oneTimeCode = Math.floor(100000 + Math.random() * 900000).toString();
  localStorage.setItem('registeredUser', JSON.stringify({
    email: document.getElementById('regEmail').value,
    password: regPassword,
    code: oneTimeCode
  }));
  alert("Un code à usage unique a été envoyé (simulation : " + oneTimeCode + ")");
  loginTab.click();
});

// Form connexion
document.getElementById('loginForm').addEventListener('submit', e => {
  e.preventDefault();
  document.getElementById('authPage').style.display = 'none';
  document.getElementById('mainContent').style.display = 'block';
  document.getElementById('candidatSection').style.display = 'block';
  document.getElementById('contentPage').style.display = 'none';
  scrollTopPage();
  updateMenuVisibility();
});
// skipAuth
document.getElementById('skipAuth').addEventListener('click', () => {
  document.getElementById('authPage').style.display = 'none';
  document.getElementById('mainContent').style.display = 'block';
  document.getElementById('candidatSection').style.display = 'block';
  document.getElementById('contentPage').style.display = 'none';
  scrollTopPage();
  updateMenuVisibility();
});

/* =====================
   SIDEBAR & NAVIGATION
===================== */
const sidebar = document.getElementById('sidebar');
document.getElementById('menuButton').addEventListener('click', () => {
  sidebar.classList.toggle('active');
});
sidebar.addEventListener('mouseleave', () => {
  sidebar.classList.remove('active');
});

document.querySelectorAll('#sidebar a').forEach(link => {
  link.addEventListener('click', function(e) {
    e.preventDefault();
    document.querySelectorAll('#sidebar a').forEach(el => el.classList.remove('active'));
    this.classList.add('active');
    sidebar.classList.remove('active');
  });
});

// Boutons
document.getElementById('coverPageBtn').addEventListener('click', e => {
  e.preventDefault();
  hideAllSections();
  document.getElementById('candidatSection').style.display = 'block';
  document.getElementById('contentPage').style.display = 'none';
  scrollTopPage();
});
document.getElementById('accueilBtn').addEventListener('click', e => {
  e.preventDefault();
  hideAllSections();
  document.getElementById('candidatSection').style.display = 'none';
  document.getElementById('accueilSection').style.display = 'block';
  document.getElementById('contentPage').style.display = 'block';
  scrollTopPage();
});
document.getElementById('inscriptionLink').addEventListener('click', e => {
  e.preventDefault();
  hideAllSections();
  document.getElementById('candidatSection').style.display = 'none';
  document.getElementById('inscriptionSection').style.display = 'block';
  document.getElementById('contentPage').style.display = 'block';
  scrollTopPage();
});
document.getElementById('suiviLink').addEventListener('click', e => {
  e.preventDefault();
  hideAllSections();
  document.getElementById('candidatSection').style.display = 'none';
  document.getElementById('suiviSection').style.display = 'block';
  document.getElementById('contentPage').style.display = 'block';
  scrollTopPage();
});
document.getElementById('examenLink').addEventListener('click', e => {
  e.preventDefault();
  hideAllSections();
  document.getElementById('candidatSection').style.display = 'none';
  document.getElementById('examenSection').style.display = 'block';
  document.getElementById('contentPage').style.display = 'block';
  scrollTopPage();
});
document.getElementById('permisLink').addEventListener('click', e => {
  e.preventDefault();
  hideAllSections();
  document.getElementById('candidatSection').style.display = 'none';
  document.getElementById('permisSection').style.display = 'block';
  document.getElementById('contentPage').style.display = 'block';
  scrollTopPage();
});

/* =====================
   FORMULAIRE CANDIDAT
===================== */
function formatDate(dateStr) {
  if (!dateStr) return "";
  const parts = dateStr.split("-");
  return parts[2] + "/" + parts[1] + "/" + parts[0];
}
function collectFormData() {
  const nephInputs = document.querySelectorAll('.neph-box input');
  return {
    nom: document.getElementById('nom').value,
    prenom: document.getElementById('prenom').value,
    dateNaissance: formatDate(document.getElementById('date-naissance').value),
    adresse: document.getElementById('adresse').value,
    codePostal: document.getElementById('code-postal').value,
    commune: document.getElementById('commune').value,
    telephone: document.getElementById('telephone').value,
    email: document.getElementById('email').value,
    responsable: document.getElementById('responsable').value,
    dateDebut: formatDate(document.getElementById('date-debut').value),
    neph: Array.from(nephInputs).map(input => input.value).join(''),
    photo: document.getElementById('photoPreview').src
  };
}
function displaySummary(data) {
  document.getElementById('sumNom').innerText = capitalize(data.nom);
  document.getElementById('sumPrenom').innerText = capitalize(data.prenom);
  document.getElementById('sumDateNaissance').innerText = data.dateNaissance;
  document.getElementById('sumAdresse').innerText = data.adresse;
  document.getElementById('sumCodePostal').innerText = data.codePostal;
  document.getElementById('sumCommune').innerText = data.commune;
  document.getElementById('sumTelephone').innerText = data.telephone;
  document.getElementById('sumEmail').innerText = data.email;
  document.getElementById('sumResponsable').innerText = capitalize(data.responsable);
  document.getElementById('sumNeph').innerText = data.neph;
  document.getElementById('sumDateDebut').innerText = data.dateDebut;
  document.getElementById('sumPhoto').src = data.photo ? data.photo : "";
}

/* Soumission du formulaire */
document.getElementById('infoForm').addEventListener('submit', e => {
  e.preventDefault();
  const formData = collectFormData();
  localStorage.setItem('validatedData', JSON.stringify(formData));
  // Masquer le formulaire et afficher le résumé
  document.getElementById('infoForm').style.display = 'none';
  displaySummary(formData);
  document.getElementById('summaryView').style.display = 'block';
  
  document.getElementById('editBtn').style.display = 'inline-block';
  document.getElementById('resetBtn').style.display = 'inline-block';
  document.getElementById('demarrerBtn').style.display = 'inline-block';
  scrollTopPage();
});

/* Bouton "Modifier" */
document.getElementById('editBtn').addEventListener('click', () => {
  document.getElementById('summaryView').style.display = 'none';
  document.getElementById('infoForm').style.display = 'block';
  document.getElementById('editBtn').style.display = 'none';
  document.getElementById('resetBtn').style.display = 'none';
  document.getElementById('demarrerBtn').style.display = 'none';
});

/* Bouton "Réinitialiser" */
document.getElementById('resetBtn').addEventListener('click', () => {
  localStorage.removeItem('validatedData');
  document.getElementById('summaryView').style.display = 'none';
  document.getElementById('infoForm').reset();
  
  document.getElementById('editBtn').style.display = 'none';
  document.getElementById('resetBtn').style.display = 'none';
  document.getElementById('demarrerBtn').style.display = 'none';
  
  document.getElementById('infoForm').style.display = 'block';
  
  const photoPreview = document.getElementById('photoPreview');
  photoPreview.src = "";
  photoPreview.style.display = 'none';
  document.getElementById('photoPlaceholderText').style.display = 'block';
});

/* Bouton "Démarrer" */
document.getElementById('demarrerBtn').addEventListener('click', () => {
  document.getElementById('candidatSection').style.display = 'none';
  document.getElementById('contentPage').style.display = 'block';
  hideAllSections();
  document.getElementById('accueilSection').style.display = 'block';
  scrollTopPage();
});

/* Lien unique "Informations Candidat" => renvoie formulaire ou récap */
document.getElementById('infosLink').addEventListener('click', e => {
  e.preventDefault();
  hideAllSections();
  document.getElementById('candidatSection').style.display = 'block';
  document.getElementById('contentPage').style.display = 'none';

  const validatedData = localStorage.getItem('validatedData');
  if (validatedData) {
    // Affiche le récap
    document.getElementById('infoForm').style.display = 'none';
    document.getElementById('summaryView').style.display = 'block';
    document.getElementById('editBtn').style.display = 'inline-block';
    document.getElementById('resetBtn').style.display = 'inline-block';
    document.getElementById('demarrerBtn').style.display = 'inline-block';
  } else {
    // Affiche le formulaire
    document.getElementById('infoForm').style.display = 'block';
    document.getElementById('summaryView').style.display = 'none';
  }
  scrollTopPage();
});

/* =====================
   AUTOCOMPLÉTION ADRESSE
===================== */
function initAutocomplete() {
  const addressInput = document.getElementById('adresse');
  if (!addressInput) return;
  const autocomplete = new google.maps.places.Autocomplete(addressInput, {
    componentRestrictions: { country: "fr" },
    fields: ["address_components", "formatted_address", "geometry", "name"]
  });
  autocomplete.addListener('place_changed', () => {
    const place = autocomplete.getPlace();
    if (!place.address_components) return;

    let postalCode = "";
    let commune = "";

    place.address_components.forEach(component => {
      if (component.types.includes("postal_code")) {
        postalCode = component.long_name;
      }
      if (component.types.includes("locality")) {
        commune = component.long_name;
      }
    });

    if (postalCode) document.getElementById('code-postal').value = postalCode;
    if (commune) document.getElementById('commune').value = commune;
  });
}

/* =====================
   NEPH BOX AUTOFOCUS
===================== */
document.querySelectorAll('.neph-box input').forEach((input, index, inputs) => {
  input.addEventListener('input', () => {
    if (input.value.length === input.maxLength) {
      const nextInput = inputs[index + 1];
      if (nextInput) nextInput.focus();
    }
  });
});

/* =====================
   SUIVI DES SESSIONS
===================== */
function ajouterSession() {
  const date = document.getElementById('dateSession').value;
  const lieu = document.getElementById('lieuSession').value;
  const trafic = document.getElementById('traficSession').value;
  const element = document.getElementById('elementSession').value;
  const autoEval = document.getElementById('autoEvalSession').value;
  const progression = document.getElementById('progressionSession').value;
  const assistance = document.getElementById('assistanceSession').value;
  const remarques = document.getElementById('remarquesSession').value;
  const objectifs = document.getElementById('objectifsSession').value;

  if (!date) {
    alert("Veuillez sélectionner une date.");
    return;
  }
  const tbody = document.getElementById('suiviTbody');
  const tr = document.createElement('tr');
  tr.innerHTML = `
    <td>${date}</td>
    <td>${lieu}</td>
    <td>${trafic}</td>
    <td>${element}</td>
    <td>${autoEval}</td>
    <td>${progression}</td>
    <td>${assistance}</td>
    <td>${remarques}</td>
    <td>${objectifs}</td>
  `;
  tbody.appendChild(tr);
  document.getElementById('suiviForm').reset();
  mettreAJourIndicateurs();
}
function mettreAJourIndicateurs() {
  const totalSessions = document.querySelectorAll('#suiviTbody tr').length;
  const cible = 10;
  const pourcentage = Math.min(Math.round((totalSessions / cible) * 100), 100);
  document.getElementById('pratiqueProgress').innerText = pourcentage + "%";
}

/* =====================
   INITIALISATION
===================== */
window.addEventListener('load', () => {
  initAutocomplete();
  // Gestion de l'upload photo
  const fileInput = document.querySelector('.photo-placeholder input[type="file"]');
  if (fileInput) {
    fileInput.addEventListener('change', e => {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(evt) {
          const photoPreview = document.getElementById('photoPreview');
          photoPreview.src = evt.target.result;
          photoPreview.style.display = 'block';
          document.getElementById('photoPlaceholderText').style.display = 'none';
        };
        reader.readAsDataURL(file);
      }
    });
  }
});
</script>
</body>
</html>
